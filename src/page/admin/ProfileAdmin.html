<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Trang Qu·∫£n Tr·ªã - SkyDrone</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
    <!-- Bootstrap Bundle (g·ªìm c·∫£ Popper) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet" href="../../stylesheets/admin/ProfileAdmin.css">
</head>
<body>

<!-- ===== HEADER ===== -->
<header class="main-header">
    <div class="logo">
        <img src="/image/logoo2.png" alt="Logo">
        <h2>SkyDrone Admin</h2>
    </div>
    <div class="header-right">
        <!-- Icon admin + t√™n -->
        <a href="/page/admin/ProfileAdmin.html" class="text-decoration-none text-while">
        <div class="thong-tin-admin d-flex align-items-center gap-2">
            <i class="bi bi-person-circle fs-4"></i>
            <span class="fw-semibold">Admin</span>
        </div>
        </a>

        <button class="logout-btn" id="logoutBtn" title="ƒêƒÉng xu·∫•t">
            <i class="bi bi-box-arrow-right"></i>
        </button>
    </div>
    <div class="logout-modal" id="logoutModal">
        <div class="logout-modal-content">
            <p>B·∫°n c√≥ ch·∫Øc mu·ªën ƒëƒÉng xu·∫•t kh√¥ng?</p>
            <div class="logout-actions">
                <a href="../login.html">
                    <button id="confirmLogout" class="confirm">C√≥</button>
                </a>
                <button id="cancelLogout" class="cancel">Kh√¥ng</button>
            </div>
        </div>
    </div>
</header>

<!-- ===== LAYOUT ===== -->
<div class="layout">
    <!-- === SIDEBAR === -->
    <aside class="sidebar">
        <div class="user-info">
            <img src="https://i.pravatar.cc/80" alt="Avatar">
            <h3>M·∫°c Nguy√™n</h3>
            <p>Ch√†o m·ª´ng b·∫°n tr·ªü l·∫°i üëã</p>
        </div>

        <ul class="menu">
            <a href="dashboard.html">
                <li><i class="bi bi-speedometer2"></i> T·ªïng Quan</li>
            </a>
            <a href="QuanLyKhachHang.html">
                <li><i class="bi bi-person-lines-fill"></i> Qu·∫£n L√Ω T√†i Kho·∫£n</li>
            </a>
            <a href="product-management.html">
                <li class="active"><i class="bi bi-box-seam"></i> Qu·∫£n L√Ω S·∫£n Ph·∫©m</li>
            </a>
            <a href="QuanLyDanhMuc.html">
                <li><i class="bi bi-tags"></i> Qu·∫£n L√Ω Danh M·ª•c</li>
            </a>

            <li class="has-submenu">
                <div class="menu-item">
                    <i class="bi bi-truck"></i>
                    <span>Qu·∫£n L√Ω ƒê∆°n H√†ng</span>
                    <i class="bi bi-chevron-right arrow"></i>
                </div>
                <ul class="submenu">
                    <a href="QuanLyDonHangChuaXacNhan.html">
                        <li>Ch∆∞a X√°c Nh·∫≠n</li>
                    </a>
                    <a href="QuanLyDonHangDaXacNhan.html">
                        <li>ƒê√£ X√°c Nh·∫≠n</li>
                    </a>
                </ul>
            </li>

            <a href="QuanLyBlog.html">
                <li><i class="bi bi-journal-text"></i> Qu·∫£n L√Ω Blog</li>
            </a>
            <a href="QuanLyKhuyenMai.html">
                <li><i class="bi bi-megaphone"></i> Qu·∫£n L√Ω Khuy·∫øn M√£i</li>
            </a>
            <a href="thongKe.html">
                <li><i class="bi bi-bar-chart"></i> B√°o C√°o & Th·ªëng K√™</li>
            </a>
        </ul>
    </aside>


    <div class="profile-page">
        <!-- LEFT SIDE -->
        <div class="profile-left">
            <div class="avatar-box">
                <div class="avatar-wrapper">
                    <img src="https://i.pravatar.cc/80" alt="Avatar" class="avatar-img">
                    <span class="avatar-camera">
        <i class="bi bi-camera-fill"></i>
    </span>
                </div>
                <input type="file" id="avatar-upload" accept="image/*" hidden>
            </div>
            <h3>M·∫°c Nguy√™n</h3>
        </div>
    </div>

    <!-- RIGHT SIDE -->
    <div class="profile-right">
        <!-- Th√¥ng tin c∆° b·∫£n -->
        <h4>Th√¥ng tin c∆° b·∫£n</h4>
        <form id="profileForm">
            <label>H·ªç t√™n
                <input name="fullname" value="M·∫°c Nguy√™n">
            </label>
            <label>Email
                <input type="email" name="email" value="macnguyen123@gmail.com">
            </label>
            <label>S·ªë ƒëi·ªán tho·∫°i
                <input name="phone" value="0123456789">
            </label>
            <label>T√™n c·ª≠a h√†ng
                <input name="storeName" value="SkyDrone">
            </label>
            <div class="actions">
                <button type="submit" class="btn">L∆∞u thay ƒë·ªïi</button>
            </div>
        </form>

        <hr>

        <!-- Th√¥ng tin thanh to√°n -->
        <h4>Th√¥ng tin ng√¢n h√†ng</h4>

        <!-- Hi·ªÉn th·ªã B·∫£n ƒë·ªçc (masked) -->
        <div class="bank-container">
            <div class="bank-info" id="bankView">
                <button class="btn btn-primary edit-btn">
                    <i class="bi bi-pencil-fill"></i> Ch·ªânh s·ª≠a
                </button>


                <p><strong>Ng√¢n h√†ng:</strong> <span id="bankNameText">Vietcombank</span></p>
                <p><strong>S·ªë t√†i kho·∫£n:</strong> <span id="acctMasked">**** **** 1234</span></p>
                <p><strong>Ch·ªß t√†i kho·∫£n:</strong> <span id="acctNameText">M·∫°c Nguy√™n</span></p>

                <div id="qrContainerView" style="margin-top: 12px; text-align: center;">
                    <p><strong>M√£ QR thanh to√°n:</strong></p>
                    <img src="/image/qr/qr.png" alt="QR Code"
                         style="width: 120px; height: 120px; border: 1px dashed #ccc; border-radius: 6px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                </div>
            </div>


            <div class="bank-info-edit hidden" id="bankEdit">
                <form id="bankForm">
                    <label>Ng√¢n h√†ng
                        <select name="bankName" id="bankName" required>
                            <option value="">-- Ch·ªçn ng√¢n h√†ng --</option>
                            <option value="Momo">Momo</option>
                            <option value="VNPay">VNPay</option>
                            <option value="Vietcombank">Vietcombank</option>
                            <option value="BIDV">BIDV</option>
                            <option value="Techcombank">Techcombank</option>
                            <option value="MB Bank">MB Bank</option>
                            <option value="Agribank">Agribank</option>
                            <option value="ACB">ACB</option>
                            <option value="Sacombank">Sacombank</option>
                        </select>
                    </label>

                    <label>S·ªë t√†i kho·∫£n
                        <div class="account-field">
                            <input name="accountNumber" id="accountNumber" value="12341234" required>
                            <i id="toggleEye" class="fa-solid fa-eye"></i>
                        </div>
                    </label>

                    <label>Ch·ªß t√†i kho·∫£n
                        <input name="accountHolder" id="accountHolder" value="Nguy·ªÖn Ng·ªçc Linh" required>
                    </label>

                    <label>M√£ QR thanh to√°n
                        <div class="qr-upload-wrapper" style="margin-top: 8px; text-align: center;">
                            <div class="qr-upload-box">
                                <img id="qrPreviewImg" src="" alt="QR Preview"
                                     style="width: 120px; height: 120px; border: 1px dashed #ccc; border-radius: 6px; display: none;">
                                <div class="qr-plus-icon">
                                    <i class="fa-solid fa-plus"></i>
                                </div>
                            </div>
                            <input type="file" id="qrUpload" accept="image/*" hidden>
                        </div>
                    </label>

                    <div class="btn-group">
                        <button type="submit" class="btn">L∆∞u</button>
                        <button type="button" id="btnCancelBank" class="btn btn-secondary">H·ªßy</button>
                    </div>
                </form>
            </div>
        </div>

        <hr>

        <!-- L·ªãch s·ª≠ ho·∫°t ƒë·ªông -->
        <h4>L·ªãch s·ª≠ ho·∫°t ƒë·ªông g·∫ßn ƒë√¢y</h4>
        <div class="activity-log">
            <table>
                <thead>
                <tr>
                    <th>Th·ªùi gian</th>
                    <th>Ho·∫°t ƒë·ªông</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td>12/11/2025 10:32</td>
                    <td>ƒêƒÉng nh·∫≠p v√†o h·ªá th·ªëng</td>
                </tr>
                <tr>
                    <td>11/11/2025 15:20</td>
                    <td>Ch·ªânh s·ª≠a khuy·∫øn m√£i ‚ÄúSale 11.11‚Äù</td>
                </tr>
                <tr>
                    <td>10/11/2025 09:10</td>
                    <td>Duy·ªát ƒë∆°n h√†ng #DH0052</td>
                </tr>
                </tbody>
            </table>
        </div>

        <hr>

        <!-- ƒê·ªïi m·∫≠t kh·∫©u -->
        <h4>ƒê·ªïi m·∫≠t kh·∫©u</h4>
        <form id="changePassForm">
            <small class="password-hint">
                M·∫≠t kh·∫©u ph·∫£i c√≥ √≠t nh·∫•t 8 k√Ω t·ª±, bao g·ªìm ch·ªØ hoa, ch·ªØ th∆∞·ªùng, s·ªë v√† k√Ω t·ª± ƒë·∫∑c bi·ªát.
            </small>
            <label>M·∫≠t kh·∫©u c≈©
                <input type="text" name="oldPassword" required>
            </label>
            <label>M·∫≠t kh·∫©u m·ªõi
                <input type="text" name="newPassword" required minlength="8">
            </label>
            <label>X√°c nh·∫≠n m·∫≠t kh·∫©u
                <input type="text" name="confirmPassword" required>
            </label>
            <div class="actions">
                <button type="submit" class="btn btn-primary">ƒê·ªïi m·∫≠t kh·∫©u</button>
            </div>
            <p id="passMsg" class="muted"></p>
        </form>
    </div>
</div>


</div>
</div>

<script>
    // === TO√ÄN B·ªò JS NG√ÇN H√ÄNG: POPUP + TOGGLE EYE + QR (KH√îNG L∆ØU) ===
    document.addEventListener("DOMContentLoaded", function () {
        // === ELEMENTS ===
        const bankView = document.getElementById('bankView');
        const bankEdit = document.getElementById('bankEdit');
        const btnEdit = document.getElementById('btn-edit-bank');
        const btnCancel = document.getElementById('btnCancelBank');
        const bankForm = document.getElementById('bankForm');
        const saveBtn = bankForm.querySelector('button[type="submit"]');

        const accountNumberInput = document.getElementById('accountNumber');
        const toggleEye = document.getElementById('toggleEye');
        const acctMasked = document.getElementById('acctMasked');

        const qrUpload = document.getElementById('qrUpload');
        const qrPreviewImg = document.getElementById('qrPreviewImg');
        const qrUploadBox = document.querySelector('.qr-upload-box');

        // === D·ªÆ LI·ªÜU GI·∫¢ L·∫¨P ===
        let actualAcct = accountNumberInput.value || '12341234';
        let masked = true;

        // === MASK S·ªê T√ÄI KHO·∫¢N ===
        function maskAccount(acct) {
            const s = (acct || '').toString().replace(/\s+/g, '').replace(/[^0-9]/g, '');
            if (!s) return '----';
            const last4 = s.slice(-4);
            const maskedPart = s.slice(0, -4).replace(/\d/g, '*');
            return (maskedPart + last4).replace(/(.{4})/g, '$1 ').trim();
        }

        function updateMasked() {
            acctMasked.textContent = maskAccount(actualAcct);
        }

        // === TOGGLE EYE (HI·ªÜN/·∫®N S·ªê TK) ===
        toggleEye.addEventListener('click', () => {
            masked = !masked;
            if (masked) {
                accountNumberInput.value = maskAccount(actualAcct);
                toggleEye.classList.replace('fa-eye-slash', 'fa-eye');
            } else {
                accountNumberInput.value = actualAcct;
                toggleEye.classList.replace('fa-eye', 'fa-eye-slash');
            }
        });

        // === CH·ªåN ·∫¢NH QR ===
        qrUpload.addEventListener('change', function () {
            const file = this.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = e => {
                    qrPreviewImg.src = e.target.result;
                    qrPreviewImg.style.display = 'block';
                };
                reader.readAsDataURL(file);
            } else {
                qrPreviewImg.style.display = 'none';
            }
        });

        // === M·ªû POPUP ===
        btnEdit.addEventListener('click', () => {
            bankView.classList.add('hidden');
            bankEdit.classList.remove('hidden');

            // Kh√¥i ph·ª•c s·ªë TK + tr·∫°ng th√°i m·∫Øt
            accountNumberInput.value = masked ? maskAccount(actualAcct) : actualAcct;
            toggleEye.classList.toggle('fa-eye-slash', !masked);
            toggleEye.classList.toggle('fa-eye', masked);

        });

        // === H·ª¶Y ===
        btnCancel.addEventListener('click', () => {
            bankEdit.classList.add('hidden');
            bankView.classList.remove('hidden');
            qrUpload.value = '';
            qrPreviewImg.style.display = 'none';
        });
        saveBtn.disabled = true;
        // === KH·ªûI T·∫†O ===
        updateMasked();
    });

    // ch·ªçn ·∫£nh qr trong popup
    document.addEventListener('click', function (e) {
        if (e.target.closest('.qr-upload-box')) {
            e.preventDefault();
            const input = document.getElementById('qrUpload');
            if (input) input.click();
        }
    });
</script>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const wrapper = document.querySelector(".avatar-wrapper");
        const upload = document.querySelector("#avatar-upload");
        const img = document.querySelector("#avatar-img");

        // Khi click v√†o avatar => m·ªü h·ªôp ch·ªçn ·∫£nh
        wrapper.addEventListener("click", () => upload.click());

        // Khi ng∆∞·ªùi d√πng ch·ªçn ·∫£nh m·ªõi => hi·ªÉn th·ªã preview
        upload.addEventListener("change", (e) => {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = () => (img.src = reader.result);
                reader.readAsDataURL(file);
            }
        });
    });
</script>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const current = window.location.pathname.split("/").pop();
        const links = document.querySelectorAll(".sidebar li a");

        links.forEach(link => {
            const linkPage = link.getAttribute("href");

            if (linkPage === current) {
                link.classList.add("active");
            }
        });
    });
</script>
</body>
</html>
